# Интеграция админской панели с Backend API

## Обзор

Админская панель теперь полностью интегрирована с backend API для управления приложениями. Реализованы все CRUD операции с обработкой ошибок и уведомлениями.

## Структура файлов

### Новые файлы:

- `src/utils/api.js` - Конфигурация axios с JWT аутентификацией
- `src/services/applicationsService.js` - Сервис для работы с API приложений
- `src/test-integration.js` - Тестовый скрипт для проверки интеграции

### Обновленные файлы:

- `src/pages/Applications.js` - Полностью переработанный компонент

## Функциональность

### ✅ Реализованные возможности:

1. **Получение списка приложений**

   - Загрузка с сервера
   - Отображение в таблице с пагинацией
   - Показ количества пользователей

2. **Создание приложения**

   - Форма с валидацией
   - Проверка уникальности имени
   - Автоматическое обновление списка

3. **Редактирование приложения**

   - Предзаполнение формы
   - Блокировка изменения имени
   - Обновление данных

4. **Удаление приложения**

   - Подтверждение действия
   - Проверка наличия пользователей
   - Безопасное удаление

5. **Обработка ошибок**

   - Показ уведомлений об ошибках
   - Обработка сетевых ошибок
   - Автоматический редирект при истечении токена

6. **UX улучшения**
   - Индикаторы загрузки
   - Валидация форм
   - Уведомления об успешных операциях

## API Endpoints

### Админские роуты (требуют JWT токен):

- `GET /applications/admin` - Список приложений
- `GET /applications/admin/:id` - Информация о приложении
- `POST /applications/admin/create` - Создание приложения
- `PUT /applications/admin/:id` - Обновление приложения
- `DELETE /applications/admin/:id` - Удаление приложения

## Настройка

### 1. Запуск Backend сервера

```bash
cd backend
npm run start:dev
```

Сервер должен запуститься на порту 3066.

### 2. Запуск админской панели

```bash
cd admin
npm start
```

Админская панель запустится на порту 3065 с прокси на backend.

### 3. Аутентификация

Для работы с админскими функциями необходимо:

1. Получить JWT токен через `POST /api/admin/login`
2. Сохранить токен в localStorage как `admin_token`
3. Токен автоматически добавляется к запросам

## Использование

### Создание приложения:

1. Нажмите "Создать приложение"
2. Заполните форму:
   - **Имя приложения** - уникальное имя для API (например: `etf-tracker`)
   - **Отображаемое название** - название для пользователей (например: `ETF Flow Tracker`)
   - **Описание** - опциональное описание
   - **Статус** - активность приложения
3. Нажмите "Создать"

### Редактирование приложения:

1. Нажмите иконку редактирования в таблице
2. Измените нужные поля (имя нельзя изменить)
3. Нажмите "Обновить"

### Удаление приложения:

1. Нажмите иконку удаления в таблице
2. Подтвердите действие
3. Приложение будет удалено (только если нет пользователей)

## Обработка ошибок

### Типы ошибок:

- **400** - Неверные данные (показывается в форме)
- **401** - Не авторизован (редирект на логин)
- **404** - Приложение не найдено
- **409** - Конфликт (например, имя уже существует)
- **500** - Ошибка сервера

### Уведомления:

- Успешные операции - зеленые уведомления
- Ошибки - красные уведомления
- Автоматическое скрытие через 6 секунд

## Тестирование

### Автоматическое тестирование:

```bash
# В консоли браузера на странице Applications
import('./test-integration.js').then(module => module.default());
```

### Ручное тестирование:

1. Откройте админскую панель
2. Перейдите на страницу "Приложения"
3. Попробуйте создать, редактировать и удалить приложение
4. Проверьте уведомления и обработку ошибок

## Troubleshooting

### Проблемы с подключением:

1. **"Сервер недоступен"**

   - Проверьте, что backend запущен на порту 3066
   - Проверьте прокси в package.json

2. **"Необходима авторизация"**

   - Проверьте наличие JWT токена в localStorage
   - Получите новый токен через логин

3. **"CORS ошибка"**
   - Проверьте настройки CORS в backend
   - Убедитесь, что прокси настроен правильно

### Логи для отладки:

- Откройте Developer Tools → Console
- Все API запросы логируются
- Ошибки показываются с подробностями

## Дальнейшее развитие

### Возможные улучшения:

1. **Кэширование** - сохранение данных в localStorage
2. **Оптимистичные обновления** - мгновенное обновление UI
3. **Пагинация** - для больших списков приложений
4. **Поиск и фильтрация** - по имени, статусу, дате
5. **Экспорт данных** - в CSV/Excel формате
6. **Массовые операции** - удаление/изменение нескольких приложений

### Интеграция с другими модулями:

- Управление пользователями приложений
- Статистика и аналитика
- Настройки уведомлений
- Логи и мониторинг
