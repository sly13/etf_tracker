# üèóÔ∏è –ú—É–ª—å—Ç–∏–ø—Ä–∏–ª–æ–∂–µ–Ω—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `Application`

```sql
- id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- name: —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: 'etf.flow', 'crypto.tracker')
- displayName: –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: 'ETF Flow Tracker')
- description: –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- isActive: –∞–∫—Ç–∏–≤–Ω–æ –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- createdAt, updatedAt: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
```

### –¢–∞–±–ª–∏—Ü–∞ `User`

```sql
- id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- applicationId: —Å–≤—è–∑—å —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- deviceToken: FCM —Ç–æ–∫–µ–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- telegramChatId: Telegram Chat ID (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- firstName, lastName, email, phone: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- deviceType, appVersion, osVersion, language, timezone, deviceName: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- enableETFUpdates, enableSignificantFlow, enableTestNotifications, enableTelegramNotifications: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- minFlowThreshold, significantChangePercent: –ø–æ—Ä–æ–≥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- quietHoursStart, quietHoursEnd: —Ç–∏—Ö–∏–µ —á–∞—Å—ã
- isValid, isActive: —Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- lastUsed, lastNotificationSent, notificationCount: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- telegramLinkedAt: –∫–æ–≥–¥–∞ –ø—Ä–∏–≤—è–∑–∞–Ω Telegram
- createdAt, updatedAt: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
```

## üîß API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
POST /applications/register-device
{
  "token": "fcm_token_here",
  "appName": "etf.flow",
  "deviceInfo": {
    "deviceType": "android",
    "appVersion": "1.0.0",
    "osVersion": "14",
    "language": "ru",
    "timezone": "Europe/Moscow",
    "deviceName": "Samsung Galaxy S21",
    "firstName": "–ò–≤–∞–Ω",
    "lastName": "–ü–µ—Ç—Ä–æ–≤",
    "email": "ivan@example.com",
    "phone": "+7900123456"
  }
}
```

### –ü—Ä–∏–≤—è–∑–∫–∞ Telegram

```http
POST /applications/link-telegram
{
  "deviceToken": "fcm_token_here",
  "telegramChatId": "123456789"
}
```

### –û—Ç–≤—è–∑–∫–∞ Telegram

```http
POST /applications/unlink-telegram
{
  "deviceToken": "fcm_token_here"
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

```http
GET /applications/etf.flow
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```http
GET /applications/etf.flow/stats
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

```http
GET /applications/user/{deviceToken}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```http
POST /applications/user/{deviceToken}/settings
{
  "enableETFUpdates": true,
  "enableTelegramNotifications": true,
  "minFlowThreshold": 0.5
}
```

### –¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

```http
POST /applications/user/{deviceToken}/test-notification
```

## üì± –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### ETF Flow Tracker (`etf.flow`)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤ ETF
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: ETF –ø–æ—Ç–æ–∫–∏, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Telegram**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

### Crypto Tracker (`crypto.tracker`)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Telegram**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

### Portfolio Manager (`portfolio.manager`)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–µ–Ω–µ–¥–∂–µ—Ä –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: ETF –ø–æ—Ç–æ–∫–∏, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Telegram**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

### Trading Bot (`trading.bot`)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –¢–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- **Telegram**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

## ü§ñ Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ê–∫—Ç–∏–≤–∞—Ü–∏—è Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/stop` - –û—Ç–∫–ª—é—á–µ–Ω–∏–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/status` - –°—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞
- `/help` - –°–ø—Ä–∞–≤–∫–∞

### –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–≤—è–∑–∫–∏

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–∞–∑–¥–µ–ª "Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
3. –ù–∞–∂–∏–º–∞–µ—Ç "–ü—Ä–∏–≤—è–∑–∞—Ç—å Telegram"
4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É `/start` –±–æ—Ç—É
5. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç Chat ID
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç Chat ID –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
7. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç API –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏

## üîî –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. **ETF Updates** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ETF –ø–æ—Ç–æ–∫–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è ETF –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
2. **Significant Flow** - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤
3. **Test Notifications** - —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. **Telegram Notifications** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

### –õ–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- Firebase —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
npx prisma migrate dev --name multi-app-architecture
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

```env
TELEGRAM_BOT_TOKEN=your_bot_token
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ ETF –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
curl -X POST http://localhost:3000/applications/register-device \
  -H "Content-Type: application/json" \
  -d '{
    "token": "test_token",
    "appName": "etf.flow",
    "deviceInfo": {
      "deviceType": "android",
      "firstName": "–¢–µ—Å—Ç",
      "lastName": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    }
  }'

# –ü—Ä–∏–≤—è–∑–∫–∞ Telegram
curl -X POST http://localhost:3000/applications/link-telegram \
  -H "Content-Type: application/json" \
  -d '{
    "deviceToken": "test_token",
    "telegramChatId": "123456789"
  }'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

```
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ ETF Flow Tracker: test_token...
‚úÖ Telegram –∞–∫–∫–∞—É–Ω—Ç 123456789 –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é user_id
‚úÖ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ: 5 —É—Å–ø–µ—à–Ω–æ, 0 –æ—à–∏–±–æ–∫
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —è–∑—ã–∫–∞–º

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
- Telegram Chat ID —É–Ω–∏–∫–∞–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è FCM —Ç–æ–∫–µ–Ω–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üéØ –ì–æ—Ç–æ–≤–æ!

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –ö–∞–∂–¥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
